--- server.py
+++ server.py
@@ -1,3 +1,4 @@
 import os
 import json
 import uuid
@@ -5,6 +6,7 @@
 import logging
 from datetime import datetime
 from typing import Dict, List, Optional, Set
 from pathlib import Path
+from websockets.exceptions import ConnectionClosedError

 from fastapi import FastAPI, WebSocket, WebSocketDisconnect, UploadFile, File, Form, HTTPException
 from fastapi.responses import FileResponse, HTMLResponse, JSONResponse
@@ -13,6 +15,7 @@
 from pydantic import BaseModel
 import uvicorn

+# 导入配置
 from config import *

 # 配置日志
@@ -349,6 +352,15 @@
         await state_manager.broadcast_to_display(ControlCommand(
            type="pause"
        ))
        
+        # 更新当前时间
+        if 'time' in command_data:
+            state_manager.current_time = command_data['time']
+            # 发送时间更新给所有管理端
+            await state_manager.broadcast_to_admin(ControlCommand(
+                type="time_update",
+                data={"time": state_manager.current_time}
+            ))
+        
         await state_manager.broadcast_to_admin(ControlCommand(
             type="state_update",
@@ -485,9 +497,8 @@
         else:
             await state_manager.broadcast_to_display(ControlCommand(
                 type="switch_to_slide",
-                data={"slide": state_manager.current_slide.dict() if state_manager.current_slide else None}
                 data={
-                    "slide": state_manager.current_slide.dict() if state_manager.current_slide else None
+                    "slide": state_manager.current_slide.dict() if state_manager.current_slide else None
                 }
             ))
         
@@ -512,7 +523,7 @@
                 type="state_update",
                 data={
                     "current_slide_index": state_manager.current_slide_index,
-                    "current_slide": state_manager.current_slide.dict()
+                    "current_slide": state_manager.current_slide.dict() if state_manager.current_slide else None
                 }
             ))

@@ -528,16 +539,17 @@
                 # 处理显示端的时间更新
                 if data.get("type") == "time_update":
                     state_manager.current_time = data.get("data", {}).get("time", 0)
                     
                     # 广播给所有管理端
                     await state_manager.broadcast_to_admin(ControlCommand(
                         type="time_update",
                         data={"time": state_manager.current_time}
                     ))
                     
-            except Exception as e:
+            except (json.JSONDecodeError, KeyError) as e:
                 logger.error(f"处理显示端消息时出错: {e}")
                 
-    except (WebSocketDisconnect, ConnectionClosedError):
+    except WebSocketDisconnect:
         state_manager.disconnect_display(websocket)
         logger.info("显示端WebSocket连接断开")
     except Exception as e:
        logger.error(f"处理显示端连接时出错: {e}")
        state_manager.disconnect_display(websocket)